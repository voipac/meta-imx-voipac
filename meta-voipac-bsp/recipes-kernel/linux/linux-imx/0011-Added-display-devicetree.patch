From 7b2ec49ad73275e9e10c8b7afa814b5f813b323f Mon Sep 17 00:00:00 2001
From: Marek Belisko <marek.belisko@open-nandra.com>
Date: Mon, 10 Jun 2024 21:56:25 +0200
Subject: [PATCH] Added display devicetree

Signed-off-by: Marek Belisko <marek.belisko@open-nandra.com>
---
 arch/arm64/boot/dts/freescale/Makefile        |   3 +-
 .../imx93-voipac-evk-boe-wxga-lvds-panel.dts  | 102 ++++++++++++++++++
 2 files changed, 104 insertions(+), 1 deletion(-)
 create mode 100644 arch/arm64/boot/dts/freescale/imx93-voipac-evk-boe-wxga-lvds-panel.dts

diff --git a/arch/arm64/boot/dts/freescale/Makefile b/arch/arm64/boot/dts/freescale/Makefile
index b436a5f3d2be..f49a0ebd2d3c 100644
--- a/arch/arm64/boot/dts/freescale/Makefile
+++ b/arch/arm64/boot/dts/freescale/Makefile
@@ -375,7 +375,8 @@ dtb-$(CONFIG_ARCH_MXC) += imx93-11x11-evk.dtb \
 			  imx93-11x11-evk-mt9m114.dtb \
 			  imx93-11x11-evk-ld.dtb \
 			  imx93-11x11-evk-rpmsg.dtb imx93-11x11-evk-rpmsg-lpv.dtb \
-			  imx93-voipac-evk.dtb
+			  imx93-voipac-evk.dtb \
+			  imx93-voipac-evk-boe-wxga-lvds-panel.dtb
 
 imx93-11x11-evk-pmic-pf0900-dtbs := imx93-11x11-evk.dtb imx93-11x11-evk-pmic-pf0900.dtbo
 imx93-11x11-evk-pmic-pf0900-root-dtbs := imx93-11x11-evk-root.dtb imx93-11x11-evk-pmic-pf0900.dtbo
diff --git a/arch/arm64/boot/dts/freescale/imx93-voipac-evk-boe-wxga-lvds-panel.dts b/arch/arm64/boot/dts/freescale/imx93-voipac-evk-boe-wxga-lvds-panel.dts
new file mode 100644
index 000000000000..2d4bfbf96bec
--- /dev/null
+++ b/arch/arm64/boot/dts/freescale/imx93-voipac-evk-boe-wxga-lvds-panel.dts
@@ -0,0 +1,102 @@
+// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
+/*
+ * Copyright 2022 NXP
+ */
+
+#include "imx93-voipac-evk.dts"
+
+/ {
+        backlight_reg: regulator-backlight {
+                compatible = "regulator-fixed";
+                regulator-name = "backlight";
+                regulator-min-microvolt = <1800000>;
+                regulator-max-microvolt = <1800000>;
+                gpio = <&gpio_xten0 0 GPIO_ACTIVE_HIGH>;
+                enable-active-high;
+	};
+
+       	lvds_backlight: blvds_backlight {
+                compatible = "pwm-backlight";
+                pwms = <&tpm4 0 5000000 0>;
+                brightness-levels = <0 100>;
+                num-interpolated-steps = <100>;
+                default-brightness-level = <80>;
+                power-supply = <&backlight_reg>;
+                status = "okay";
+        };
+
+	lvds_panel {
+		compatible = "boe,ev121wxm-n10-1850";
+		backlight = <&lvds_backlight>;
+
+		port {
+			panel_lvds_in: endpoint {
+				remote-endpoint = <&lvds_out>;
+			};
+		};
+	};
+};
+
+&dphy {
+	status = "disabled";
+};
+
+&dsi {
+	status = "disabled";
+};
+
+&lcdif {
+	assigned-clock-rates = <498000000>, <71142857>, <400000000>, <133333333>;
+};
+
+&ldb {
+	status = "okay";
+
+	lvds-channel@0 {
+		status = "okay";
+
+		port@1 {
+			reg = <1>;
+
+			lvds_out: endpoint {
+				remote-endpoint = <&panel_lvds_in>;
+			};
+		};
+	};
+};
+
+&ldb_phy {
+	status = "okay";
+};
+
+&lpi2c2 {
+	exc80h60: touch@2a {
+		compatible = "eeti,exc80h60";
+		reg = <0x2a>;
+		interrupt-parent = <&gpio_ext_som>;
+		interrupts = <7 IRQ_TYPE_LEVEL_LOW>;
+		status = "okay";
+	};
+};
+
+&tpm4 {
+	status = "okay";
+	pinctrl-names = "default";
+	pinctrl-0 = <&lcd_pwm>;
+};
+
+
+&iomuxc {
+	pinctrl_ctp_int: ctp_int_grp {
+		fsl,pins = <
+			MX93_PAD_GPIO_IO21__GPIO2_IO21          0x31e
+		>;
+	};
+
+	lcd_pwm: lcd_pwm {
+		fsl,pins = <
+			MX93_PAD_GPIO_IO21__TPM4_CH1               0x0000051E
+		>;
+	};
+	
+};
-- 
2.34.1

